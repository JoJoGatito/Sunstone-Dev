<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Setup RLS Policies - Sunstone Inclusivity Network</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="supabase-config.js"></script>
  <script src="setup-rls-policies.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link href="https://www.dyslexiefont.com/css/dyslexie.css" rel="stylesheet" type="text/css"/>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { dyslexie: ["Dyslexie", "sans-serif"] },
        },
      },
    };
  </script>
</head>
<body class="bg-black text-white font-dyslexie">
  <nav class="bg-black p-4">
    <div class="max-w-7xl mx-auto">
      <a href="index.html" class="text-yellow-500 hover:text-yellow-400">
        <i class="fas fa-arrow-left mr-2"></i>Back to Main Page
      </a>
    </div>
  </nav>

  <main class="max-w-4xl mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold text-yellow-500 mb-8">Setup RLS Policies</h1>
    
    <div class="bg-gray-900 p-6 rounded-lg mb-8">
      <h2 class="text-2xl font-bold text-yellow-500 mb-4">Operation Results</h2>
      <div id="results">
        <!-- Results will be dynamically inserted here -->
      </div>
    </div>

    <div class="bg-gray-900 p-6 rounded-lg">
      <h2 class="text-2xl font-bold text-yellow-500 mb-4">Console Output</h2>
      <pre id="console-output" class="bg-black p-4 rounded text-sm font-mono overflow-x-auto">
        <!-- Console output will be displayed here -->
      </pre>
    </div>

    <div class="mt-8 bg-gray-900 p-6 rounded-lg">
      <h2 class="text-2xl font-bold text-yellow-500 mb-4">Policy Summary</h2>
      <div class="space-y-6">
        <div>
          <h3 class="text-xl text-yellow-500 mb-2">Groups Table Policies</h3>
          <ul class="list-disc list-inside space-y-1 text-gray-300">
            <li>Enable read access for all users</li>
            <li>Enable insert for testing</li>
            <li>Enable delete for testing</li>
          </ul>
        </div>
        <div>
          <h3 class="text-xl text-yellow-500 mb-2">Events Table Policies</h3>
          <ul class="list-disc list-inside space-y-1 text-gray-300">
            <li>Enable read access for all users</li>
            <li>Enable insert for testing</li>
            <li>Enable delete for testing</li>
          </ul>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Capture console output
    const originalConsole = {
      log: console.log,
      error: console.error,
      warn: console.warn
    };

    const consoleOutput = document.getElementById('console-output');
    
    function formatTime() {
      return new Date().toLocaleTimeString();
    }

    console.log = function(...args) {
      originalConsole.log.apply(console, args);
      consoleOutput.innerHTML += `[${formatTime()}] LOG: ${args.join(' ')}\n`;
    };

    console.error = function(...args) {
      originalConsole.error.apply(console, args);
      consoleOutput.innerHTML += `[${formatTime()}] ERROR: ${args.join(' ')}\n`;
    };

    console.warn = function(...args) {
      originalConsole.warn.apply(console, args);
      consoleOutput.innerHTML += `[${formatTime()}] WARN: ${args.join(' ')}\n`;
    };
  </script>
</body>
</html>